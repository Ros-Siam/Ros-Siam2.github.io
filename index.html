<script>
  const sheetId = '1Q3BtiVhjrvgFTIvTnXucu6W5nti_oShVCkarUADogH4'; // เปลี่ยนเป็นไฟล์ใหม่ที่คุณให้มา
  const apiUrl = `https://opensheet.elk.sh/${sheetId}/Sheet1`;

  const grabLogo = 'https://drive.google.com/thumbnail?id=1vhOumfzWD7xseUY1YMqfHab7fdbln_Mg';
  const linemanLogo = 'https://drive.google.com/thumbnail?id=1WmMY7RkgnNNJBMLiid2OMevP0d4a-Dgq';

  async function fetchData() {
    try {
      const res = await fetch(apiUrl);
      const data = await res.json();

      const preparing = document.getElementById('preparing');
      const ready = document.getElementById('ready');

      preparing.innerHTML = '';
      ready.innerHTML = '';

      data.forEach(row => {
        const orderNumber = row["กำลังเตรียมอาหาร"]?.trim();
        const readyNumber = row["พร้อมส่ง"]?.trim();

        if (orderNumber) {
          const logo = orderNumber.length === 3 ? grabLogo : linemanLogo;
          preparing.innerHTML += `
            <div class="order-row">
              <img src="${logo}" />
              <span class="order-number">${orderNumber}</span>
            </div>`;
        }

        if (readyNumber) {
          const logo = readyNumber.length === 3 ? grabLogo : linemanLogo;
          ready.innerHTML += `
            <div class="order-row">
              <img src="${logo}" />
              <span class="order-number">${readyNumber}</span>
            </div>`;
        }
      });
    } catch (err) {
      console.error('Error fetching data:', err);
    }
  }

  fetchData();
  setInterval(fetchData, 3000);
</script>
