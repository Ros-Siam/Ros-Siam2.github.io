<script>
  // เปลี่ยน sheetId ให้เป็น Google Sheet ใหม่
  const sheetId = '1Q3BtiVhjrvgFTIvTnXucu6W5nti_oShVCkarUADogH4';
  const apiUrl = `https://opensheet.elk.sh/${sheetId}/Sheet1`;

  // URL โลโก้
  const grabLogo = 'https://drive.google.com/thumbnail?id=1vhOumfzWD7xseUY1YMqfHab7fdbln_Mg';
  const linemanLogo = 'https://drive.google.com/thumbnail?id=1WmMY7RkgnNNJBMLiid2OMevP0d4a-Dgq';

  async function fetchData() {
    try {
      const res = await fetch(apiUrl);
      const data = await res.json();

      const preparing = document.getElementById('preparing');
      const ready = document.getElementById('ready');

      preparing.innerHTML = '';
      ready.innerHTML = '';

      data.forEach(row => {
        const orderPreparing = row["กำลังเตรียมอาหาร"]?.trim();
        const orderReady = row["พร้อมส่ง"]?.trim();

        if (orderPreparing) {
          const logo = orderPreparing.length === 3 ? grabLogo : linemanLogo;
          preparing.innerHTML += `
            <div class="order-row">
              <img src="${logo}" alt="logo" />
              <span class="order-number">${orderPreparing}</span>
            </div>`;
        }

        if (orderReady) {
          const logo = orderReady.length === 3 ? grabLogo : linemanLogo;
          ready.innerHTML += `
            <div class="order-row">
              <img src="${logo}" alt="logo" />
              <span class="order-number">${orderReady}</span>
            </div>`;
        }
      });
    } catch (err) {
      console.error('Error fetching data:', err);
    }
  }

  fetchData();
  setInterval(fetchData, 3000);
</script>
